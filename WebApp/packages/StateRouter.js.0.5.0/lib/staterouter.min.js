"use strict";var staterouter=function(){function normalizePath(path){return"/"!==path[0]&&(path="/"+path),path}function getRelativeUrl(url){return url.replace(/^(?:\/\/|[^\/]+)*\/?/,"")}function isEmpty(obj){for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function getCurrentPath(state){var link=document.createElement("a");return void 0===state&&(state=History.getState()),link.href=state.url,normalizePath(link.pathname)}function Router(){function onStateChange(){self.perform()}var self=this;self.routes={},self.route=function(path,func){var route;return path=normalizePath(path),route="^"+path.replace(/:\w+/g,"([^/]+)")+"$",self.routes[route]=func,self},self.navigate=function(path,data,title){var currentUrl,currentTitle,currentData,currentState=History.getState();if(currentUrl=currentState.url,currentData=currentState.data,currentTitle=currentState.title,isEmpty(currentData)&&(currentData=void 0),currentTitle||(currentTitle=void 0),"/"!==path[0]){var currentPath=getCurrentPath();"/"!==currentPath.slice(-1)[0]&&(currentPath+="/"),path=currentPath+path}return path!==normalizePath(getRelativeUrl(currentUrl))||data!==currentData||title!==currentTitle?History.pushState(data,title,path):$(window).trigger("statechange"),self},self.perform=function(){var route,rx,match,func,state=History.getState(),path=getCurrentPath(state);for(route in self.routes)if(self.routes.hasOwnProperty(route)&&(rx=RegExp(route),match=rx.exec(path),null!==match)){func=self.routes[route],func.apply(state,match.slice(1));break}return self},self.back=function(){return History.back(),self},self.go=function(steps){return History.go(steps),self},History.Adapter.bind(window,"statechange",onStateChange)}return{Router:Router}}();